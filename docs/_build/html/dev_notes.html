
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="ko">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Dev Notes &#8212; pywinauto 0.6.5 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/translations.js"></script>
    
    <link rel="index" title="색인" href="genindex.html" />
    <link rel="search" title="검색" href="search.html" />
    <link rel="next" title="PYWINAUTO TODO&#39;s" href="TODO.html" />
    <link rel="prev" title="Credits" href="credits.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>탐색</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="전체 색인"
             accesskey="I">색인</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python 모듈 목록"
             >모듈</a> |</li>
        <li class="right" >
          <a href="TODO.html" title="PYWINAUTO TODO&#39;s"
             accesskey="N">다음</a> |</li>
        <li class="right" >
          <a href="credits.html" title="Credits"
             accesskey="P">이전</a> |</li>
        <li class="nav-item nav-item-0"><a href="contents.html">pywinauto 0.6.5 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="dev-notes">
<h1>Dev Notes<a class="headerlink" href="#dev-notes" title="제목 주소">¶</a></h1>
<div class="section" id="file-layout">
<h2>FILE LAYOUT<a class="headerlink" href="#file-layout" title="제목 주소">¶</a></h2>
<p># used by just about everything (and considered a block!)
win32defines.py
win32functions.py
win32structures.py</p>
<p># Find windows and their attributes
findwindows.py
handleprops.py</p>
<p># wrap windows, get extra info for particular controls
# set the friendly class name
controlscommon_controls.py
controlscontrolactions.py
controlshwndwrapper.py
controlswin32_controls.py</p>
<p># currently depends on the Friendly class name
# probably needs to be refactored to make it independent of controls!
# maybe move that stuff to _application_?
findbestmatch.py  # currently depends on controls!</p>
<p>controlactions.py</p>
<p>testsallcontrols.py
testsasianhotkey.py
testscomboboxdroppedheight.py
testscomparetoreffont.py
testsleadtrailspaces.py
testsmiscvalues.py
testsmissalignment.py
testsmissingextrastring.py
testsoverlapping.py
testsrepeatedhotkey.py
teststranslation.py
teststruncation.py</p>
<p>controlproperties.py</p>
<p>xml_helpers.py</p>
<blockquote>
<div>FindDialog.py
PyDlgCheckerWrapper.py</div></blockquote>
<p>application.py
test_application.py</p>
</div>
<div class="section" id="best-matching">
<h2>Best matching<a class="headerlink" href="#best-matching" title="제목 주소">¶</a></h2>
<p>difflib provides this support
For menu's it is simple we match against the text of the menu item.
For controls the story is more complicated because we want to match
against the following:</p>
<blockquote>
<div><ul class="simple">
<li>Control text if it exists</li>
<li>Friendly Class name</li>
<li>Control text + Friendly class name (if control text exists)</li>
<li>(Possibly) closest static + FriendlyClassName</li>
</ul>
</div></blockquote>
<dl class="docutils">
<dt>e.g.</dt>
<dd>FindWhatCombo, ComboBox1,</dd>
<dt>or</dt>
<dd>Text, TextRiadio, RadioButton2</dd>
</dl>
<ol class="arabic simple">
<li>the control itself knows what it should be referred to</li>
<li>Need to disambiguate across all controls in the dialog</li>
<li>then we need to match</li>
</ol>
</div>
<div class="section" id="attribute-resolution">
<h2>ATTRIBUTE RESOLUTION<a class="headerlink" href="#attribute-resolution" title="제목 주소">¶</a></h2>
<p>Thinking again...
app.dlg.control</p>
<dl class="docutils">
<dt>TWO LEVELS</dt>
<dd><ul class="first last simple">
<li><dl class="first docutils">
<dt>application.member (Python resolves)</dt>
<dd>an attribute of application object</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>application.dialog</dt>
<dd>a dialog reference</dd>
</dl>
</li>
</ul>
</dd>
<dt>THREE LEVELS</dt>
<dd><ul class="first last simple">
<li><dl class="first docutils">
<dt>application.member.attr (Python resolves)</dt>
<dd>another attribute of the previous member</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>application.dialog.member</dt>
<dd>a member of the dialog object</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>application.dialog.control</dt>
<dd>a control on the dialog</dd>
</dl>
</li>
</ul>
</dd>
<dt>FOUR LEVELS (leaving out Python resolved)</dt>
<dd><ul class="first last simple">
<li>application.dialog.member.member</li>
<li>application.dialog.control.member</li>
</ul>
</dd>
</dl>
<p>DELAYED RESOLUTION FOR SUCCESS
Taking the example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">app</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">action</span><span class="p">()</span>
</pre></div>
</div>
<p>If we leave out syntax and programming errors there are still a number of reasons why it could fail.</p>
<p>dlg might not be found
control might not be found
either dlg or control may be disabled</p>
<p>dialog and control may be found but on the wrong dialog (e.g. in Notepad you can bring up 2 &quot;Page Setup&quot; dialogs both with an OK button)</p>
<p>One solution would just be to add a &quot;sleep&quot; before trying to find each new dialog (to ensure that it is there and ready) - but this will mean lots of unnecessary waiting.</p>
<dl class="docutils">
<dt>So the solution I have tried is:</dt>
<dd><ul class="first last simple">
<li>perform the complete attribute access resolution at the latest possible time</li>
<li>if it fails then wait and try again</li>
<li>after a specified timeout fail raising the original exception.</li>
</ul>
</dd>
</dl>
<p>This means that in the normal case you don't have unnecessary waits - and in the failure case - you still get an exception with the error.</p>
<p>Also waiting to do resolution as late as possible stops errors where an earlier part of the path succeedes - but finds the wrong item.</p>
<p>So for example if  finds the page setup dialog in Notepad
# open the Printer setup dialog (which has &quot;Page Setup&quot; as title)
app.PageSetup.Printer.Click()</p>
<p># if this runs too quickly it actually finds the current page setup dialog
# before the next dialog opens, but that dialog does not have a Properties
# button - so an error is raised.
# because we re-run the resolution from the start we find the new pagesetup dialog.
app.PageSetup.Properties.Click()</p>
</div>
<div class="section" id="writing-to-dialogs">
<h2>WRITING TO DIALOGS<a class="headerlink" href="#writing-to-dialogs" title="제목 주소">¶</a></h2>
<p>We need a way of making sure that the dialog is active without having to access a control on it.
e.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">app</span><span class="o">.</span><span class="n">MainWin</span><span class="o">.</span><span class="n">MenuSelect</span><span class="p">(</span><span class="s2">&quot;Something That-&gt;Loads a Dialog&quot;</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">Dlg</span><span class="o">.</span><span class="n">_write</span><span class="p">(</span><span class="s2">&quot;dlg.xml&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>or a harder problem:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">app</span><span class="o">.</span><span class="n">PageSetup</span><span class="o">.</span><span class="n">Printer</span><span class="o">.</span><span class="n">Click</span><span class="p">()</span>
<span class="n">app</span><span class="o">.</span><span class="n">PageSetup</span><span class="o">.</span><span class="n">_write</span><span class="p">(</span><span class="s2">&quot;pagesetup.xml&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>In this second example it is very hard to be sure that the correct Page Setup dialog is shown.</p>
<p>The only way to be realy sure is to check for the existance of certain control(s) (ID, Class, text, whatever) - but it would be nice to not have to deal with those :-(</p>
<p>Another less declarative (more magic?) is to scan the list of available windows/controls and if they haven't changed then accept that the correct one is shown.</p>
<p>When testing and having XML files then we should use those to make sure that we have the correct dialog up (by using Class/ID)</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="contents.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Dev Notes</a><ul>
<li><a class="reference internal" href="#file-layout">FILE LAYOUT</a></li>
<li><a class="reference internal" href="#best-matching">Best matching</a></li>
<li><a class="reference internal" href="#attribute-resolution">ATTRIBUTE RESOLUTION</a></li>
<li><a class="reference internal" href="#writing-to-dialogs">WRITING TO DIALOGS</a></li>
</ul>
</li>
</ul>

  <h4>이전 항목</h4>
  <p class="topless"><a href="credits.html"
                        title="이전 장">Credits</a></p>
  <h4>다음 항목</h4>
  <p class="topless"><a href="TODO.html"
                        title="다음 장">PYWINAUTO TODO's</a></p>
  <div role="note" aria-label="source link">
    <h3>현재 문서</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/dev_notes.txt"
            rel="nofollow">소스 코드를 보려면</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>빠른 검색</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="바로 가기" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>탐색</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="전체 색인"
             >색인</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python 모듈 목록"
             >모듈</a> |</li>
        <li class="right" >
          <a href="TODO.html" title="PYWINAUTO TODO&#39;s"
             >다음</a> |</li>
        <li class="right" >
          <a href="credits.html" title="Credits"
             >이전</a> |</li>
        <li class="nav-item nav-item-0"><a href="contents.html">pywinauto 0.6.5 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Mark Mc Mahon and Contributors.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.2.
    </div>
  </body>
</html>